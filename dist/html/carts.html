<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>购物车</title><script src="../js/jquery-1.4.2.js"></script><script src="../js/jquery.cookie.js"></script><script src="../js/js.cookie.js"></script><link rel="stylesheet" href="../css/style.css"><link rel="stylesheet" href="../css/other.css"><script src="../js/move.js"></script><script src="../js/main.js"></script><script src="../js/getJsonLength.js"></script></head><body><div class="cart-header"></div><div class="gCart"><div class="hd"><h3>我的购物车</h3></div><div class="bd"><div class="cartList"><div class="hd"><div class="col1">商品信息</div><div class="col2">单价</div><div class="col3">数量</div><div class="col4">小计</div><div class="col5">操作</div></div><ul class="bd" id="buy-items"></ul><div class="gAmount">商品总计： <span id="totalP"></span> 元</div><div class="btn"><input style="float:left;margin-left:2px;margin-right:4px;margin-top:4px" type="checkbox" class="check checks"><label class="quanxuan" style="float:left">全选</label><a href="/" class="b1" title="继续购物" data-monitor="shopcart_continueshop_click">继续购物</a> <a href="javascript:void(0);" class="b2" title="去结算">去结算</a></div></div></div></div><div class="cart-footer"></div></body><script>function getMoney(){for(var t=$(".wrap_row"),e=0,a=0,r=0,i=0;i<t.length;i++)t[i].getElementsByTagName("input")[0].checked&&(a=parseFloat($(t[i]).find(".danjian").text()),e=parseFloat(t[i].getElementsByTagName("input")[1].value),r+=a*e);$("#totalP").text(r.toFixed(2))}var cartName=getCookie("loginedUser");""==cartName&&(cartName="admin"),console.log(cartName);var goods=$.cookie("mycart"+cartName)?JSON.parse($.cookie("mycart"+cartName)):{},html="";for(var goodsId in goods)html+='<li class="wrap_row" id="'+goods[goodsId].id+'"><input style="float: left;margin-top: 34px;margin-left: 1px;margin-right: 2px;" type="checkbox" class="check"><div class="row" > <div class="r1"><img class="item-img" src="'+goods[goodsId].pic+'"> ',html+='<a class="item-namexx" href="detail.html" target="_blank">  ',html+=goods[goodsId].name,html+='</a> </div><div class="r2"><span class="danjian" style="margin-left: -30px;">',html+=goods[goodsId].price,html+='</span></div><div class="r3"><div class="gcIpt"><a href="javascript:;" class="decrement" id="decrement"></a> ',html+='<input id="goodsCount" type="text" class="goodsCount" value=" '+goods[goodsId].num+' " /><a href="javascript:;" class="increment" id="increment"></a></div>  ',html+='<div class="errTip">已达到最大购买数量</div></div><div class="r4"><span class="xiaoji"> ',html+=parseFloat(goods[goodsId].price)*parseFloat(goods[goodsId].num),html+='</span>元</div><div class="r5"><a href="javascript:;" class="delOrder">删除</a></div></div></li>';$("#buy-items").html(html),getMoney(),$(".btn .b2").click(function(){if(0==getJsonLength(goodsId,goods))tip("购物车不能为空");else{var t=getCookie("loginedUser");""==t?tip("请先登录"):location.href="pay.html"}});var check=$(".check"),checks=$(".checks");$(check).each(function(){$(this).click(function(){if($(this).hasClass("checks"))for(var t=0;t<check.length;t++)check[t].checked=this.checked;this.checked||$(checks).attr("checked",!1),getMoney()})}),$(".increment").live("click",function(){var t=$(this).prev().val(),e=parseInt(t)+1;0==e&&(tip(),e=1),e>20&&(tip(),e=20,$(this).prev().val(e)),$(this).prev().val(e);var a=parseInt($(this).parent().parent(".r3").prev("").find(".danjian").text());$(this).parent().parent(".r3").next().find(".xiaoji").text(e*a),getMoney();var r=$(this).parent().parent().parent().parent().attr("id");goods[r].num=e,$.cookie("mycart"+cartName,JSON.stringify(goods),{expires:7,path:"/"})}),$(".decrement").live("click",function(){var t=$(this).next().val(),e=parseInt(t)-1;0==e&&(tip(),e=1),e>20&&(tip(),e=20),$(this).next().val(e);var a=parseInt($(this).parent().parent(".r3").prev("").find(".danjian").text());$(this).parent().parent(".r3").next().find(".xiaoji").text(e*a),getMoney();var r=$(this).parent().parent().parent().parent().attr("id");goods[r].num=e,$.cookie("mycart"+cartName,JSON.stringify(goods),{expires:7,path:"/"})}),$(".delOrder").live("click",function(){$(this).parent().parent().parent().remove();var t=$(this).parent().parent().parent().attr("id");goods[t]=void 0,$.cookie("mycart"+cartName,JSON.stringify(goods),{expires:7,path:"/"}),getMoney()}),$("#goodsCount").live("keyup",function(){this.value=this.value.replace(/[^0-9-]+/,"")}),$("#goodsCount").live("blur",function(){var t=$(this).val();if(t<1){tip(),t=1,$(this).val(t);var e=parseInt($(this).parent().parent(".r3").prev("").find(".danjian").text());$(this).parent().parent(".r3").next().find(".xiaoji").text(t*e),getMoney();var a=$(this).parent().parent().parent().parent().attr("id");return goods[a].num=t,void $.cookie("mycart"+cartName,JSON.stringify(goods),{expires:7,path:"/"})}if(t>20){tip(),t=20,$(this).val(t);var e=parseInt($(this).parent().parent(".r3").prev("").find(".danjian").text());$(this).parent().parent(".r3").next().find(".xiaoji").text(t*e),getMoney();var a=$(this).parent().parent().parent().parent().attr("id");return goods[a].num=t,void $.cookie("mycart"+cartName,JSON.stringify(goods),{expires:7,path:"/"})}$(this).val(t);var e=parseInt($(this).parent().parent(".r3").prev("").find(".danjian").text());$(this).parent().parent(".r3").next().find(".xiaoji").text(t*e),getMoney();var a=$(this).parent().parent().parent().parent().attr("id");return goods[a].num=t,void $.cookie("mycart"+cartName,JSON.stringify(goods),{expires:7,path:"/"})})</script></html>